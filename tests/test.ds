#[
    This is a Test File.
]#

#[
    I dump junk here to do quick tests for
    dragonstone or to explore things I might
    integrate.

    If you happen to come across something in
    here, there's a 99% chance it's not going
    to work.

    Because it is either not working, code
    snippets that I might get integrate
    or just junk in general.
]#

echo "----------------------------"
echo "-------- Test File ---------"
echo "----------------------------"
echo "\n"
echo "Starting Test File"
echo "\n"

#[
    #! Garbage Collection and Borrow Checker

    FOR TESTING AN IDEA:
    GARBAGE COLLECTION AND 
    BORROW CHECKER VIA ANNOTATIONS

    # TODO: Need Good Garbage Collection Implementation.
    # TODO: Need Good Borrow Checker Implementation.
]#
 

# # with both gc and bc.
# @[gc.disable && bc.enable]
# def Load(area: Area) : Level
#     let doc: @own Document = Document.allocate(area)
    
#     do
#         let editor: &mut Document = &mut doc
#         editor.append("Hello")
#     end

#     alias data = doc.data
#     alias meta = doc.meta

#     let level: Level = Level.allocate(
#         data: gc.copy(data),
#         meta: gc.copy(meta)
#     )

#     doc.drop()
#     return level
# end

# GC is disabled inside this function (once attribute support exists).
# def build_cache(area) : Hash
#     cache = {}                         # GC-managed
#     doc   = Document.allocate(area)    # arena-managed

#     i = 0
#     while i < 1_000_000
#         doc.load_from_source(i)
#         cache[i] = gc.copy(doc.to_value)
#         doc.reset
#         i += 1
#     end

#     doc.drop
#     cache
# end

# def load_level(path : String) : Level
#     area = gc.begin(capacity: 64 * 1024 * 1024)

#     data     = area.allocate(bytes: 1_000_000)
#     textures = area.allocate(array: Texture, count: 256)
#     load_level_data(path, data, textures)

#     level = Level.allocate(
#         data: gc.copy(data),
#         meta: gc.copy(textures)
#     )

#     gc.end(area)
#     level
# end

# use "file_utilities"
# use "path_utilities"

# target = "./tests/test.toml"
# echo "\n#{File.read(target)}"

echo "\n"
echo "Ending Test File"
